---

layout:     post
title:      "APT动态行为分析"
subtitle:   " \"APT动态行为分析析\""
date:       2020-07-30 18:23:00
author:     "BaiDong"
header-img: "img/home-bg-art.jpg"
catalog: true
tags:
    - APT动态行为分析
---
动态虚拟机技术，将文件投放模拟环境（PE文件、Office类、邮件类、压缩包、脚本）、配有模拟用户操作，

    监控其运行过程以及所有进程的活动，对其恶意代码特征和攻击特点作出详细的分析（主机行为、网络行为、攻击特点）。
    并将继承的IDA Pro反汇编程序对恶意代码进行处理得到相应的机器指令，提取特征信息，通过恶意程序MD5值获取相关信息。
    代码字符串检索获得相应的功能调用解释，功能行为及模块调用，同时通过可疑代码的资源节来获得图标、菜单界面、代码版本等特征。
    ----
    1）未知威胁识别
        行为监控和行为分析的方法识别未知的威胁，包括杀伤链投递缓解的0day漏洞、免杀木马等
        行为监控主要通过内核级应用，包括Ring3层监控与Ring0层监控，未知行为判别恶意程度依靠大数据行为威胁度量方法。
    2）对象检测
        针对文件对象，进程，服务，注册表，内存，网络等对象检测，通过样本的运行日志，监控发现如进程的创建、终止，服务的创建，
        注册表的访问、改写、新增和删除，内存dump，文件的增删改查和下载，网络C2行为、网络法宝、域名解析等行为。
    3）核心威胁分类
        对远程控制、拒绝服务、网银盗号、勒索者、下载识别者、建立模型。对核心行为、核心代码分类识别。
        主要手段是组合行为模型，如获取系统信息，发送C&C信道，具有键盘记录、文件、进程查看等功能判定为远程控制代码。
        具有各种攻击指令则为DDos功能。通过大量已经表示的分类的恶意代码中学习行为组合模式。
    4）污点C&C提取
        该方法依托HOOK技术，在样本中记录api信息，包括：API名称、API参数、参数地址等，记录信息包括字符串拷贝相关的API以及参数地址，
        网络连接、信息发送相关的API以及参数地址，并且提取地址相应的字符串，以及send函数参数中socket对应的IP地址，
        若被提取的相关信息（计算机配置信息等）包含在buf的地址段中，则通过socket回溯出信息被发送的目标IP地址和端口。
        快速提取、收集计算机上线信息的C&C地址。
    5）系统信标联动
        分析c&c等网络方面的信息，也可以分析产生系统层面的IOC特征，包裹hash、互斥量服务名、注册表等系统特征，
        既可以报告页面中展出也可以文件方式向其他网络设备输入情报信息，

